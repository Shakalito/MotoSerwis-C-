@page "/Client/Add"
@attribute [StreamRendering]

@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Identity
@using MotoSerwis.Components.Account.Shared.Extensions
@using MotoSerwis.Data

<h1>Formularz zgłoszenia klienta</h1>
<div class="row">
    <div class="col-md-4">
        <EditForm Model="Input" method="post" OnValidSubmit="FormSubmit" FormName="addClient">
            <StatusMessage Message="@errorMessage" />
            <DataAnnotationsValidator />
            <hr />
            <ValidationSummary class="text-danger" role="alert" />
            <div class="form-floating mb-3">
                <InputText @bind-Value="Input.FirstName" class="form-control" aria-required="true" placeholder="Jan" />
                <label for="FirstName" class="form-label">Imię</label>
                <ValidationMessage For="() => Input.FirstName" class="text-danger" />
            </div>
            <div class="form-floating mb-3">
                <InputText @bind-Value="Input.LastName" class="form-control" aria-required="true" placeholder="Kowalski" />
                <label for="LastName" class="form-label">Nazwisko</label>
                <ValidationMessage For="() => Input.LastName" class="text-danger" />
            </div>
            <div class="form-floating mb-3">
                <InputText @bind-Value="Input.Address" class="form-control" aria-required="true" placeholder="Rzeszów 123" />
                <label for="Address" class="form-label">Adres</label>
                <ValidationMessage For="() => Input.Address" class="text-danger" />
            </div>
            <div class="form-floating mb-3">
                <InputTextArea @bind-Value="Input.PhoneNumber" class="form-control" placeholder="123 321 123" />
                <label for="PhoneNumber" class="form-label">Numer telefonu</label>
                <ValidationMessage For="() => Input.PhoneNumber" class="text-danger" />
            </div>
            <div>
                <button type="submit" class="w-100 btn btn-lg btn-primary">Dodaj</button>
            </div>
        </EditForm>
    </div>
</div>

@code {
    private string? errorMessage;

    [SupplyParameterFromForm]
    private ClientInputModel Input { get; set; } = new();

    public async Task FormSubmit()
    {
        // TODO: Add to db
    }

    private class ClientInputModel
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string Address { get; set; }
        public string PhoneNumber { get; set; }
    }
}
